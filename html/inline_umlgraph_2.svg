<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="860px" preserveAspectRatio="none" style="width:934px;height:860px;background:#FFFFFF;" version="1.1" viewBox="0 0 934 860" width="934px" zoomAndPan="magnify"><defs><filter height="300%" id="f123wl1v4ip9d4" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="433.5" cy="16" fill="#000000" filter="url(#f123wl1v4ip9d4)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><rect fill="#000000" filter="url(#f123wl1v4ip9d4)" height="8" style="stroke:none;stroke-width:1.0;" width="80" x="393.5" y="84.5"/><rect fill="#FEFECE" filter="url(#f123wl1v4ip9d4)" height="35.0938" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="171" x="7" y="151"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="151" x="17" y="173.457">Wait on Pending Messages</text><path d="M18,67 L18,109.7031 A0,0 0 0 0 18,109.7031 L88.5,109.7031 L92.5,150.99 L96.5,109.7031 L167,109.7031 A0,0 0 0 0 167,109.7031 L167,77 L157,67 L18,67 A0,0 0 0 0 18,67 " fill="#FBFB77" filter="url(#f123wl1v4ip9d4)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M157,67 L157,77 L167,77 L157,67 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="24" y="85.4951">get new messageIDs</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="24" y="101.8467">from MessageListener</text><polygon fill="#FEFECE" filter="url(#f123wl1v4ip9d4)" points="180.5,254,192.5,266,180.5,278,168.5,266,180.5,254" style="stroke:#A80036;stroke-width:1.5;"/><rect fill="#FEFECE" filter="url(#f123wl1v4ip9d4)" height="50.1875" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="198" x="334.5" y="241"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="69" x="399" y="263.457">Call Iota API:</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="178" x="344.5" y="278.5508">ask for milestoneId for message</text><polygon fill="#FEFECE" filter="url(#f123wl1v4ip9d4)" points="401.5,332,413.5,344,401.5,356,389.5,344,401.5,332" style="stroke:#A80036;stroke-width:1.5;"/><rect fill="#000000" filter="url(#f123wl1v4ip9d4)" height="8" style="stroke:none;stroke-width:1.0;" width="80" x="361.5" y="411"/><rect fill="#FEFECE" filter="url(#f123wl1v4ip9d4)" height="35.0938" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="122" x="364.5" y="481.5"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="102" x="374.5" y="503.957">Observe Milestone</text><path d="M307,579 L307,638.0547 A0,0 0 0 0 307,638.0547 L532,638.0547 A0,0 0 0 0 532,638.0547 L532,589 L522,579 L425.11,579 L424.56,516.8 L417.11,579 L307,579 A0,0 0 0 0 307,579 " fill="#FBFB77" filter="url(#f123wl1v4ip9d4)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M522,579 L522,589 L532,589 L522,579 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="313" y="597.4951">OrderingManager keep track</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="313" y="613.8467">of all milestones</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204" x="313" y="630.1982">for which messages are processing</text><polygon fill="#FEFECE" filter="url(#f123wl1v4ip9d4)" points="332.5,487,344.5,499,332.5,511,320.5,499,332.5,487" style="stroke:#A80036;stroke-width:1.5;"/><rect fill="#FEFECE" filter="url(#f123wl1v4ip9d4)" height="50.1875" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="157" x="637" y="474"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="89" x="671" y="496.457">put message to:</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="137" x="647" y="511.5508">ConfirmedMessage map</text><polygon fill="#FEFECE" filter="url(#f123wl1v4ip9d4)" points="274.5,596.5,286.5,608.5,274.5,620.5,262.5,608.5,274.5,596.5" style="stroke:#A80036;stroke-width:1.5;"/><rect fill="#FEFECE" filter="url(#f123wl1v4ip9d4)" height="35.0938" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="325" x="595" y="591"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="305" x="605" y="613.457">start IotaMessageToTransactionTask task for milestone</text><rect fill="#FEFECE" filter="url(#f123wl1v4ip9d4)" height="35.0938" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="232" x="265.5" y="735"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="212" x="275.5" y="757.457">queue first message for this milestone</text><rect fill="#FEFECE" filter="url(#f123wl1v4ip9d4)" height="35.0938" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="172" x="403.5" y="811"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="152" x="413.5" y="833.457">start MilestoneLoadingTask</text><!--MD5=[3d0979e5f758e37e2225520d701752b0]
link start to LOOP_START--><path d="M433.5,26.22 C433.5,40.07 433.5,66.04 433.5,79.28 " fill="none" id="start-to-LOOP_START" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="433.5,84.38,437.5,75.38,433.5,79.38,429.5,75.38,433.5,84.38" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[bbd88d9c9526044c82dd1d9753074e82]
link LOOP_START to Wait on Pending Messages--><path d="M408.96,92.53 C366.47,98.06 276.65,110.98 202.5,130 C181.96,135.27 159.75,142.53 140.69,149.26 " fill="none" id="LOOP_START-to-Wait on Pending Messages" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="135.92,150.96,145.74,151.7132,140.631,149.2847,143.0595,144.1756,135.92,150.96" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[6ca33634861079838cbcecd18914c436]
link Wait on Pending Messages to #32--><path d="M107.83,186.13 C126.35,206.24 156.88,239.36 171.78,255.53 " fill="none" id="Wait on Pending Messages-to-#32" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="175.21,259.26,172.0673,249.926,171.8275,255.5778,166.1757,255.338,175.21,259.26" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="83" x="77.2957" y="253.5919">new messageIds</text><!--MD5=[5cd70bbae7219669750f5d0d88f23abf]
link #32 to Call Iota API:\nask for milestoneId for message--><path d="M192.7,266 C217.52,266 276.01,266 329.14,266 " fill="none" id="#32-to-Call Iota API:\nask for milestoneId for message" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="334.26,266,325.26,262,329.26,266,325.26,270,334.26,266" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="34" x="246.5" y="260.4189">arrived</text><!--MD5=[ab0027ee7f27feceb3b85312077bab58]
link Call Iota API:\nask for milestoneId for message to #37--><path d="M423.38,291.05 C417.9,304.05 411.36,319.59 406.86,330.26 " fill="none" id="Call Iota API:\nask for milestoneId for message-to-#37" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="404.83,335.08,412.0091,328.3375,406.7703,330.4718,404.636,325.2331,404.83,335.08" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="53" x="421.6094" y="325.0603">milestoneId</text><!--MD5=[4e49e38167e96894235be03f385b0465]
link #37 to VALID_MILESTONE--><path d="M401.5,356.09 C401.5,369.97 401.5,393.42 401.5,405.79 " fill="none" id="#37-to-VALID_MILESTONE" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="401.5,410.89,405.5,401.89,401.5,405.89,397.5,401.89,401.5,410.89" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="34" x="402.5" y="388.4189">not null</text><!--MD5=[75918a5e7ea9ffc823da58fa48a92cce]
link VALID_MILESTONE to Observe Milestone--><path d="M402.41,419.11 C405.13,428.39 413.34,456.44 419.19,476.45 " fill="none" id="VALID_MILESTONE-to-Observe Milestone" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="420.63,481.34,421.9232,471.5764,419.2169,476.5439,414.2494,473.8375,420.63,481.34" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[2d87a8f1417225e20c9a00d2c50d229e]
link VALID_MILESTONE to #47--><path d="M398.88,419.11 C389.44,430.33 356.9,469 341.16,487.71 " fill="none" id="VALID_MILESTONE-to-#47" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="337.55,492,346.4084,487.6954,340.772,488.1766,340.2908,482.5402,337.55,492" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="135" x="176.7894" y="485.0226">messages for this milestone</text><!--MD5=[6bf5c27ed94ba90e5aabd7acfdee5864]
link #47 to put message to:\nConfirmedMessage map--><path d="M337.5,491.52 C341.52,486.01 347.62,478.68 354.5,474 C383.79,454.07 394.6,453.09 429.5,447 C478.54,438.44 492.25,439.8 541.5,447 C575.7,452 612.52,462.26 643.45,472.35 " fill="none" id="#47-to-put message to:\nConfirmedMessage map" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="648.36,473.96,641.0568,467.3522,643.6095,472.4003,638.5613,474.953,648.36,473.96" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="110" x="430.5" y="451.4189">where already queued</text><!--MD5=[ab624cb626c184e44945229ae35fcb08]
link put message to:\nConfirmedMessage map to LOOP_START--><path d="M699.69,473.95 C690.82,458.15 681.5,436.65 681.5,416 C681.5,167.5 681.5,167.5 681.5,167.5 C681.5,123.4 537,101.18 468.6,93.13 " fill="none" id="put message to:\nConfirmedMessage map-to-LOOP_START" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="463.41,92.53,471.8927,97.5343,468.3771,93.1026,472.8089,89.587,463.41,92.53" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[e299161b3658ac18bef0bf23b2236e92]
link #47 to #53--><path d="M328.51,507.39 C318.62,525.73 292.85,573.49 280.84,595.75 " fill="none" id="#47-to-#53" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="278.36,600.34,286.1511,594.3152,280.7322,595.9386,279.1088,590.5196,278.36,600.34" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="56" x="201.2375" y="586.2972">milestone is</text><!--MD5=[f9015b85935ae07941a7bd88ae8d006a]
link #53 to start IotaMessageToTransactionTask task for milestone--><path d="M278.5,600.11 C282.2,593.3 288.35,584.04 296.5,579 C351.99,544.67 376,558.8 441,553 C485.71,549.01 497.47,547.36 542,553 C596.44,559.9 656.8,576.22 699.76,589.39 " fill="none" id="#53-to-start IotaMessageToTransactionTask task for milestone" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="704.65,590.9,697.2461,584.4052,699.8761,589.4135,694.8677,592.0435,704.65,590.9" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="99" x="442" y="556.4189">finished with loading</text><!--MD5=[ae336cfd1ed4a5203534a9f296012509]
link start IotaMessageToTransactionTask task for milestone to LOOP_START--><path d="M696.99,590.99 C654.6,575.32 605.5,547.03 605.5,500 C605.5,167.5 605.5,167.5 605.5,167.5 C605.5,111.87 529.94,95.72 478.99,91.15 " fill="none" id="start IotaMessageToTransactionTask task for milestone-to-LOOP_START" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="473.83,90.72,482.4679,95.4515,478.8128,91.134,483.1303,87.479,473.83,90.72" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[11d017388423f9da9b34c9b0c9935fff]
link #53 to queue first message for this milestone--><path d="M279.38,615.97 C294.48,636.01 340.95,697.69 365.66,730.48 " fill="none" id="#53-to-queue first message for this milestone" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="368.86,734.72,366.6381,725.125,365.8509,730.7269,360.2491,729.9396,368.86,734.72" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="338.5" y="691.4189">else</text><!--MD5=[15a2b2a704f7e52ea886451db6ee19b0]
link queue first message for this milestone to start MilestoneLoadingTask--><path d="M405.74,770.11 C422.13,781.34 443.86,796.23 461.07,808.02 " fill="none" id="queue first message for this milestone-to-start MilestoneLoadingTask" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="465.34,810.95,460.1762,802.5634,461.2152,808.124,455.6546,809.1631,465.34,810.95" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[634a98dc070447a9ffa68e2ac7502f19]
link start MilestoneLoadingTask to LOOP_START--><path d="M522.17,810.81 C542,798.12 563.5,778.57 563.5,753.5 C563.5,167.5 563.5,167.5 563.5,167.5 C563.5,119.89 498.6,100.62 460.51,93.41 " fill="none" id="start MilestoneLoadingTask-to-LOOP_START" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="455.55,92.51,463.6978,98.0429,460.4707,93.3969,465.1168,90.1698,455.55,92.51" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[51a5eb586aff114a85d1fde79bd0878c]
link #37 to LOOP_START--><path d="M392.98,340.28 C376.21,334.41 339.26,318.78 324.5,291 C314.07,271.38 317.68,262.15 324.5,241 C345.29,176.51 404.85,116.28 425.97,96.39 " fill="none" id="#37-to-LOOP_START" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="429.86,92.77,420.5388,95.9504,426.1915,96.1673,425.9745,101.82,429.86,92.77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="16" x="339.5" y="218.4189">null</text><!--MD5=[c29b38924c7cbe8a18c12bf09c75c1e8]
link #32 to LOOP_START--><path d="M182.36,255.63 C187.08,234.17 201.5,181.01 233.5,151 C275.98,111.16 343.7,97.1 388.37,92.16 " fill="none" id="#32-to-LOOP_START" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="393.43,91.62,384.0575,88.594,388.458,92.1486,384.9033,96.5491,393.43,91.62" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="52" x="234.5" y="173.4189">not arrived</text><!--MD5=[a0e91058621bb44c6d8a59a75ae9dca0]
@startuml inline_umlgraph_2.svg
(*top) - -> ===LOOP_START===
- -> "Wait on Pending Messages"
note top
    get new messageIDs
    from MessageListener
end note
- -> if "new messageIds" then 
    ->[arrived] "Call Iota API:\nask for milestoneId for message"
    if "milestoneId" then
        - ->[not null ]===VALID_MILESTONE===
        - -> "Observe Milestone"
        note bottom
            OrderingManager keep track
            of all milestones 
            for which messages are processing
        end note

        ===VALID_MILESTONE=== if "messages for this milestone" then
        ->[where already queued] "put message to:\nConfirmedMessage map"
        - -> ===LOOP_START===
        else
            if "milestone is" then
            ->[finished with loading] "start IotaMessageToTransactionTask task for milestone"
            - -> ===LOOP_START===
            else
                - - ->[else] "queue first message for this milestone"
                - -> "start MilestoneLoadingTask"
                - -> ===LOOP_START===
            endif
        endif
    else 
        ->[null]===LOOP_START===
    endif
else
    ->[not arrived]===LOOP_START===
endif
@enduml

PlantUML version 1.2022.1(Tue Feb 01 19:19:58 CET 2022)
(APACHE source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: de
Country: DE
--></g></svg>